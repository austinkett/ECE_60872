diff --git a/src/main/java/org/elasticsearch/index/engine/EngineConfig.java b/src/main/java/org/elasticsearch/index/engine/EngineConfig.java
index 2523093446db..d90708265c9e 100644
--- a/src/main/java/org/elasticsearch/index/engine/EngineConfig.java
+++ b/src/main/java/org/elasticsearch/index/engine/EngineConfig.java
@@ -152,7 +152,12 @@
     /**
      * Creates a new {@link org.elasticsearch.index.engine.EngineConfig}
      */
-    public EngineConfig(ShardId shardId, boolean optimizeAutoGenerateId, ThreadPool threadPool, ShardIndexingService indexingService, IndexSettingsService indexSettingsService, IndicesWarmer warmer, Store store, SnapshotDeletionPolicy deletionPolicy, Translog translog, MergePolicyProvider mergePolicyProvider, MergeSchedulerProvider mergeScheduler, Analyzer analyzer, Similarity similarity, CodecService codecService, Engine.FailedEngineListener failedEngineListener) {
+    public EngineConfig(ShardId shardId, boolean optimizeAutoGenerateId, ThreadPool threadPool,
+                        ShardIndexingService indexingService, IndexSettingsService indexSettingsService,
+                        IndicesWarmer warmer, Store store, SnapshotDeletionPolicy deletionPolicy,
+                        Translog translog, MergePolicyProvider mergePolicyProvider,
+                        MergeSchedulerProvider mergeScheduler, Analyzer analyzer, Similarity similarity,
+                        CodecService codecService, Engine.FailedEngineListener failedEngineListener) {
         this.shardId = shardId;
         this.optimizeAutoGenerateId = optimizeAutoGenerateId;
         this.threadPool = threadPool;
diff --git a/src/main/java/org/elasticsearch/index/engine/InternalEngine.java b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java
index 392fd312ba44..130679a8de84 100644
--- a/src/main/java/org/elasticsearch/index/engine/InternalEngine.java
+++ b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java
@@ -31,6 +31,8 @@
 import org.apache.lucene.util.BytesRef;
 import org.apache.lucene.util.IOUtils;
 import org.elasticsearch.ElasticsearchException;
+import org.elasticsearch.ElasticsearchIllegalStateException;
+import org.elasticsearch.Version;
 import org.elasticsearch.cluster.routing.operation.hash.djb.DjbHashFunction;
 import org.elasticsearch.common.Nullable;
 import org.elasticsearch.common.lease.Releasable;
@@ -118,7 +120,20 @@ public InternalEngine(EngineConfig engineConfig) throws EngineException {
         boolean success = false;
         try {
             try {
-                upgrade3xSegments(store);
+                boolean autoUpgrade = true;
+                try {
+                    // If the index was created on 0.20.7 (Lucene 3.x) or earlier,
+                    // it needs to be upgraded
+                    autoUpgrade = Version.indexCreated(engineConfig.getIndexSettings()).onOrBefore(Version.V_0_20_7);
+                } catch (ElasticsearchIllegalStateException e) {
+                    // we weren't able to parse the version, that's fine
+                }
+                if (autoUpgrade) {
+                    logger.debug("[{}] checking for 3x segments to upgrade", shardId);
+                    upgrade3xSegments(store);
+                } else {
+                    logger.debug("[{}] skipping check for 3x segments", shardId);
+                }
             } catch (IOException ex) {
                 throw new EngineCreationFailureException(shardId, "failed to upgrade 3x segments", ex);
             }
diff --git a/src/main/java/org/elasticsearch/index/shard/IndexShard.java b/src/main/java/org/elasticsearch/index/shard/IndexShard.java
index e591048bbcfd..4caa1364a094 100644
--- a/src/main/java/org/elasticsearch/index/shard/IndexShard.java
+++ b/src/main/java/org/elasticsearch/index/shard/IndexShard.java
@@ -57,7 +57,6 @@
 import org.elasticsearch.common.unit.TimeValue;
 import org.elasticsearch.common.util.concurrent.AbstractRefCounted;
 import org.elasticsearch.common.util.concurrent.FutureUtils;
-import org.elasticsearch.env.NodeEnvironment;
 import org.elasticsearch.index.IndexService;
 import org.elasticsearch.index.VersionType;
 import org.elasticsearch.index.aliases.IndexAliasesService;
@@ -246,8 +245,9 @@ public IndexShard(ShardId shardId, @IndexSettings Settings indexSettings, IndexS
         /* create engine config */
         this.config = new EngineConfig(shardId,
                 indexSettings.getAsBoolean(EngineConfig.INDEX_OPTIMIZE_AUTOGENERATED_ID_SETTING, false),
-                threadPool, indexingService, indexSettingsService, warmer, store, deletionPolicy, translog, mergePolicyProvider, mergeScheduler,
-                analysisService.defaultIndexAnalyzer(), similarityService.similarity(), codecService, failedEngineListener);
+                threadPool, indexingService, indexSettingsService, warmer, store, deletionPolicy,
+                translog, mergePolicyProvider, mergeScheduler, analysisService.defaultIndexAnalyzer(),
+                similarityService.similarity(), codecService, failedEngineListener);
 
         logger.debug("state: [CREATED]");
 
diff --git a/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java b/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java
index 261537f119f5..8c363f69a6d7 100644
--- a/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java
+++ b/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java
@@ -73,7 +73,6 @@
 import org.elasticsearch.index.settings.IndexSettingsService;
 import org.elasticsearch.index.shard.ShardId;
 import org.elasticsearch.index.store.DirectoryService;
-import org.elasticsearch.index.store.DirectoryUtils;
 import org.elasticsearch.index.store.Store;
 import org.elasticsearch.index.store.distributor.LeastUsedDistributor;
 import org.elasticsearch.index.translog.Translog;
